import{useMemo as o,useRef as r,useCallback as e,useEffect as n,useState as t}from"react";const p=()=>"undefined"!=typeof window&&"EyeDropper"in window,s=()=>{let o="Unsupported browser.";throw o="Unsupported browser: no EyeDropper in Window. Check https://developer.mozilla.org/en-US/docs/Web/API/EyeDropper_API.",new Error("Unsupported browser: no EyeDropper in Window. Check https://developer.mozilla.org/en-US/docs/Web/API/EyeDropper_API.")},c=()=>{const o=r(),[s,c]=t(!1);n(()=>(o.current=!0,c(p()),()=>{o.current=!1}),[]);const i=e(()=>s,[s]);return[o,i]},i=o=>{const r=(o=>p()&&new EyeDropper(o))(o);var e;return(e=r)?EyeDropper.prototype.open.bind(e):s},d=t=>{const p=o(()=>i(t),[t]),[s,d]=c(),w=r(),a=e(()=>{void 0!==w.current&&w.current.abort()},[w]),l=e(async function(o){void 0===o&&(o={}),a();const{signal:r,...e}=o,n=new AbortController;w.current=n;const t=void 0!==r?(o=>{const r=new AbortController,e=()=>{r.abort();for(const r of o)r.removeEventListener("abort",e)};for(const r of o){if(r.aborted){e();break}r.addEventListener("abort",e)}return r.signal})([r,n.signal]):n.signal;try{return await p({...e,signal:t})}catch(o){throw s.current||(o.canceled=!0),o}},[w,s,a,p]);return n(()=>a,[a]),{open:l,close:a,isSupported:d}};export{d as default};
